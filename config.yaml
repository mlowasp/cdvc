seed: 1337
device: "cuda"
num_workers: 6

data:
  root: "dataset"
  train_split: "train"
  val_split: "val"
  class_names: ["not_controlled", "controlled"]

video:
  num_frames: 64
  sampling_train: "random"     # random contiguous window each access
  resize_short: 256
  crop_size: 224

flow:
  method: "farneback"          # farneback (no extra deps)
  # Farneback params (safe defaults)
  pyr_scale: 0.5
  levels: 3
  winsize: 15
  iterations: 3
  poly_n: 5
  poly_sigma: 1.2
  flags: 0
  clip_value: 20.0            # clip flow magnitude per component [-clip, +clip]
  normalize: "clip"           # clip -> scale to [-1,1]

model:
  rgb_weights: "weights/rgb_imagenet.pt"
  fusion: "mean_logit"         # mean_logit | weighted_logit
  fusion_alpha: 0.5            # only for weighted_logit (alpha*rgb + (1-alpha)*flow)
  freeze_backbones_epochs: 3   # freeze both streams for first N epochs (recommended)
  unfreeze_rgb: true
  unfreeze_flow: true

train:
  epochs: 20
  batch_size: 2
  lr: 0.0003
  weight_decay: 0.02
  grad_clip: 1.0
  amp: true
  log_every: 10
  save_dir: "runs/demolition_cls_twostream"
  resume: null

focal_loss:
  alpha: 0.75
  gamma: 2.0

eval:
  clips_per_video: 5
  aggregation: "mean_prob"     # mean_prob | mean_logit
  threshold: 0.5

scheduler:
  name: "cosine"
  warmup_epochs: 1
  step_size: 8
  gamma: 0.1
