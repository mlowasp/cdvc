seed: 1337
device: "cuda"

# Data loading
num_workers: 6

data:
  root: "dataset"
  train_split: "train"
  val_split: "val"
  class_names: ["not_controlled", "controlled"]

# Video preprocessing
video:
  num_frames: 48            # sweet spot for this dataset size
  sampling_train: "random"  # random contiguous clip per access
  resize_short: 256
  crop_size: 224

# Training
train:
  epochs: 30                # more epochs, but small capacity
  batch_size: 4             # stable gradients, avoids overfitting
  lr: 0.003                 # slightly higher to escape trivial minima
  weight_decay: 0.02
  grad_clip: 1.0
  amp: true
  log_every: 10
  save_dir: "runs/demolition_cls"
  resume: null

# Loss (Focal Loss)
focal_loss:
  alpha: 0.75               # bias toward controlled demolitions
  gamma: 2.0                # standard focal setting

# Validation / per-video aggregation
eval:
  clips_per_video: 8        # strong signal without over-smoothing
  aggregation: "mean_prob"  # more stable than logits at this scale
  threshold: 0.5            # can tune later (0.45â€“0.55)

# LR Scheduler
scheduler:
  name: "cosine"
  warmup_epochs: 1
  step_size: 8              # unused by cosine, safe to keep
  gamma: 0.1
